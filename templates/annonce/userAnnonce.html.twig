{% extends "base.html.twig" %}
{% block body %}
<div class="wrapper container">
    <div class="row">
        <div class="col-lg-9">
            <h1 class="text-center py-5">Mes Annonces</h1>
            <hr id="hrContact">
            <a href="{{path('createAnnonce')}}" class="btn btn-success ml-3 mt-4">Ajouter une annonce</a>
            {% for message in app.flashes('success') %}
                <div class="container alert alert-success mt-3" id="alertAds">
                    {{message}}
                </div>
            {% endfor %}
            {% for a in app.user.annonces %}
                <div class="row p-3 mt-2">
                    <div class="col-lg-4">
                        <img src="{{asset('images/annonce/' ~ a.images.first.src)}}" alt=""
                        class="img-fluid mt-2 imgActu">
                    </div>
                    <div class="col-lg-8">
                        <h2>{{a.title}}</h2>
                        <p>
                            {% if a.content | length >=   200 %}
                            <td>{{a.content | slice(0, 200)}}... <a href="">Voir plus</a> </td>
                            {% else %}
                            <td>{{a.content}}</td>
                            {% endif %}
                        </p>
                        <p>Categorie: {{a.annonceCat.libelle}}</p>
                        <a href="{{path('annonce_show',{'slug': a.slug})}}"><i
                                class="fas fa-book-open btn btn-primary mr-2"></i></a>
                    </div>
                </div>
                {% if a.status != 1 %}
                    <small class="pl-3">en attente de confirmation...</small>
                {% else %}
                    <small class="pl-3 pr-5">Annonce publi√©</small>
                    <a href="{{path('editAnnonce',{'slug': a.slug})}}" class="btn btn-success">Modifier</a>
                    <form method="POST" style="display:inline-block" action="{{path('supAnnonceUser',{'id':a.id})}}" onsubmit="return confirm ('Confirmer la suppression')">
                        <input type="hidden" name="_method" value="delete">
                        <input type="hidden" name="_token" value="{{csrf_token('SUP' ~ a.id)}}">
                        <input type="submit" class="btn btn-danger" value="supprimer">
                    </form>
                {% endif %}
                <hr class="hrVol my-5">
            {% endfor %}
        </div>
        <div class="col-lg-3">
            {% include "partials/sidebar.html.twig" %}
        </div>
    </div>
</div>
{% endblock %}